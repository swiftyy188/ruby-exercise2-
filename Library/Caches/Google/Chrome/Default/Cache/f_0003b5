var AsyncFetcher,ImageDetailV2,NavigationEventType,NavigationDirection,InsightsStatus,MainWindowFocusStatus,DetailPageEvent,InsightsFetcher,ImageDetailDataManager,ImageDetailFilmstrip,ImageDetailMainImage,ImageViewerDls,ImageViewerHighlights,ImageVisionFetcher,ImageInsightsVision;(function(n){function t(n,t,r,u){if(!n||!t)throw"no async url or no reponse processor";var f=sj_gx();if(!f){r&&r(n);return}f.onreadystatechange=function(){4==f.readyState&&i(n,f,t,r,u)};f.open("GET",n,!0);f.send(null)}function i(n,t,i,r,u){var f=t.responseText;200==t.status&&f!=""?i(f,n):200==t.status&&u?u(n):r&&r(n)}n.fetch=t})(AsyncFetcher||(AsyncFetcher={})),function(n){function ut(){if(i=_ge("detail_img"),p=_ge("detail_main"),v=_ge("detail_meta"),w=_ge("insights"),t.rdc("cbtn",_d.body),i&&p){_w.si_PP(new Date);yt();bt();r=Math.max(sb_de.clientHeight-l,e);s=r-e;f=0;d();pt();nt();kt();var n=Bing.Location.getHash();n&&n.indexOf("enterInsights")&&_w.scrollTo(0,s)}}function ft(){location.search.indexOf("view=detailv2")===-1&&location.reload()}function yt(){var n=typeof IDConfig!="undefined"&&IDConfig?IDConfig:null,t=n&&n.mh?n.mh:600;l=wt();e=t-l;b=n&&n.dmip?n.dmip:!1;k=n&&n.da?n.da:!1;it=n&&n.mw?n.mw:600}function pt(){if(i){var n=t.gcs(i);h.width=n&&n.maxWidth?parseInt(n.maxWidth):0;h.height=n&&n.maxHeight?parseInt(n.maxHeight):0}}function wt(){var i=0,u=_ge("miniheader"),f=_ge("detail_film"),n,r;return i+=u?t.goh(u):0,i+=f?t.goh(f):0,n=0,typeof IDConfig!="undefined"&&IDConfig&&IDConfig.mbh&&(n=IDConfig.mbh),n==0&&(r=_ge("detail_meta"),n=r?t.goh(r):0),i+n}function bt(){o=_ge("switcher");c=_ge("isb");o&&c&&sj_be(o,"click",et)}function kt(){sj_evt.bind(3,ot);sj_evt.bind(1,st);sj_be(_w,"scroll",d);sj_be(_w,"resize",nt);sj_be(_w,"popstate",ft);sj_be(_w,"unload",y);sj_evt.bind("ajax.unload",y)}function y(){sj_evt.unbind(1,st);sj_evt.unbind(3,ot);o&&c&&sj_ue(o,"click",et);sj_ue(_w,"scroll",d);sj_ue(_w,"resize",nt);sj_ue(_w,"popstate",ft);sj_ue(_w,"unload",y);sj_evt.unbind("ajax.unload",y);_w.scrollTo(0,f)}function d(){var n=GetScrollTop();n!=f&&(b||(n<s?(t.smh(i,r-n),t.sh(i,r-n),g()):f<s&&(t.smh(i,e),t.sh(i,e),g())),n-f>0&&n>rt?ni():n<=rt&&ti(),dt(),gt(),f=n)}function g(){var n=i.id;n&&(i.id="",i.id=n)}function et(){a=!0;sj_evt.fire(3)}function ot(){u==0?tt.scroll(20,0,0,0,s):tt.scroll(20,0,0,f,0)}function dt(){if(v){var n="expand";u==1?t.ac(v,n):t.rc(v,n)}}function gt(){if(o){var n="flip";u==1?k?t.ac(o,n):t.str(c,180):k?t.rc(o,n):t.str(c,0)}}function ni(){if(u==0){u=1;sj_evt.fire(0,1);var n=lt(at());a&&(a=!1,n&&ht(n,NavigationEventType.Click,"imageviewer","highlights","expand"));ct(u,n)}}function ti(){if(u==1){u=0;sj_evt.fire(0,0);var n=lt(at());a&&(a=!1,n&&ht(n,NavigationEventType.Click,"imageviewer","highlights","fold"));ct(u,n)}}function nt(){var o=screen.height?Math.min(screen.height,sb_de.clientHeight):sb_de.clientHeight,u,n;r=Math.max(o-l,e);r!=h.height&&(s=r-e,t.sh(p,r),u=b?r:Math.max(r-f,e),t.smh(i,u),t.sh(i,u),g(),h.height=r);n=Math.max(sb_de.clientWidth,it);n&&n!=h.width&&(t.smw(i,n),h.width=n);w&&t.ss(w,"minHeight",Math.max(sb_de.clientHeight-l-e,vt)+"px")}function st(){u==1&&f>s&&_w.scrollTo(0,s)}function ht(n,t,i,r,u){pInstr.logEvent(n.ns,t.name,n.key,i,{Meta:r,Mid:n.mid,Direction:u},null)}function ct(n,t){var i={},r;t&&t.mid&&(i.Mid=t.mid);r=n==1?"CI.Show":"CI.Hide";pInstr.logEvent("images",r,null,"imageinsights",i,null)}function lt(n){var t=null;return typeof ImageDetailDataManager!="undefined"&&(t=ImageDetailDataManager.getFullData(n)),t}function at(){var t=parseQueryParamsFromQuery(_w.location.search),n=parseInt(t.selectedindex);return isNaN(n)?0:n}var t=pMMUtils,tt=MMAnim,i,p,v,w,h={width:0,height:0},u=0,f=0,o,c,s,l=0,r,e=300,it,vt=300,rt=5,a,b=!0,k=!1;n.init=ut;ut()}(ImageDetailV2||(ImageDetailV2={}));NavigationEventType={Click:{name:"CI.Click"},FilmStripSwipe:{name:"CI.Scroll"},Swipe:{name:"CI.Scroll"},AutoPlay:{name:"CI.AutoClick"}},function(n){n[n.Previous=0]="Previous";n[n.Next=1]="Next"}(NavigationDirection||(NavigationDirection={})),function(n){n[n.Fold=0]="Fold";n[n.Expand=1]="Expand"}(InsightsStatus||(InsightsStatus={})),function(n){n[n.Focus=0]="Focus";n[n.Blur=1]="Blur"}(MainWindowFocusStatus||(MainWindowFocusStatus={})),function(n){n[n.StatusChange=0]="StatusChange";n[n.ActiveIndexChange=1]="ActiveIndexChange";n[n.MoreResultsLoaded=2]="MoreResultsLoaded";n[n.SwitchInsights=3]="SwitchInsights";n[n.ActiveItemChange=4]="ActiveItemChange";n[n.MainImageLoaded=5]="MainImageLoaded";n[n.AnimationStateChange=6]="AnimationStateChange";n[n.Navigation=7]="Navigation";n[n.MainWindowFocusChange=8]="MainWindowFocusChange"}(DetailPageEvent||(DetailPageEvent={})),function(n){function o(n,t,i,r,u){AsyncFetcher.fetch(s(n,t),i,function(n){h(n,t);typeof r!="undefined"&&r&&r(n)},function(n){typeof u!="undefined"&&u?u(n):typeof r!="undefined"&&r&&r(n)})}function s(n,o){var s=o?f:u,h,c,l,a;s||(t=_w.IIConfig,s=r(o));s=s.replace(/%SFX%/,String(++e));for(h in n)c=o?h+"s":h,s+="&"+c+"="+encodeURIComponent(n[h]);return i&&(l=o?n.mid.split(",")[0]:n.mid,s=!o&&(a=i.qsv("insightsbag"))?i.stb(s,a):i.atb(s,(o?"InsightsBatchMock_":"InsightsMock_")+l)),s}function r(n){var i;return i=n?t&&t.baut?t.baut:"":t&&t.aut?t.aut:"",addCommonPersistedParams(i)}function h(n,t){var i={};i.Name=t?"imageinsightsbatch":"imageinsights";i.T="CI.Error";i.TS=sb_gt();i.AppNS=_G.P;i.URL=n;pInstr.icd(i)}var i=typeof MMTestUtils!="undefined"?MMTestUtils:null,t=_w.IIConfig,u=r(!1),f=r(!0),e=0;n.fetch=o}(InsightsFetcher||(InsightsFetcher={})),function(n){function pt(){typeof IIConfig!="undefined"&&IIConfig&&IIConfig.ie&&(o=IIConfig.ie);k=[].slice.call(t.gebc(ct,_d));d=[].slice.call(t.gebc(it,_d));sj_evt.bind(7,ot);o&&sj_evt.bind(4,ht);sj_be(_w,"unload",a);sj_evt.bind("ajax.unload",a);var n=parseInt(pMMUtils.qsv("selectedIndex",!0));u=isNaN(n)?0:n}function a(){sj_evt.unbind(7,ot);o&&sj_evt.unbind(4,ht);sj_ue(_w,"unload",a);sj_evt.unbind("ajax.unload",a)}function v(n,t,i){var r=i?dt(n):s(n),u,f,e;return r&&t&&(u=g(r),u&&(r[lt]=u),f=gt(r),e="brq",f&&typeof r[e]=="undefined"&&(r.brq=f[e])),r}function ft(){return l||(l=v(u)),l}function wt(n){var t=v(n),i=t?t.cidx:null;return typeof i=="number"?i:n}function bt(n,t){var i=s(n);i&&!i[ut]&&(i[ut]=t)}function kt(n){var s,f,e,h;if(typeof n=="undefined"&&(n=!1),s=_ge("ivd"),f=s?t.ga(s,"json-data"):null,f&&f.length>0){f=decodeURIComponent(f.replace(/\+/g,"%20"));try{e=JSON.parse(f)}catch(c){e=eval("("+f+")")}e&&e[tt]&&(ti(e[tt],n),ii(e[yt]),sj_evt.fire(2,i,r));t.r(s.parentNode,s)}o&&(h=u,nt(h,function(n,t){y(n);p(h,t)},function(n){p(h,n)}))}function y(n){var l=sj_ce("div"),r,u,i,f,o,s,c;if(l.innerHTML=n,r=t.gebc(it,l),r)for(u=0;u<r.length;u++)(i=t.ga(r[u],at),f=t.ga(r[u],b),i&&f)&&(e[i]||(e[i]={}),o=e[i],o[f]||(o[f]=r[u].innerHTML),s=t.ga(r[u],vt),s&&(h[i]||(h[i]={}),c=h[i],c[f]||(c[f]=JSON.parse(s))))}function s(n){if(n>=i)while(n<=r){var t=f[n];if(t)return t;n++}return null}function dt(n){if(n<=r)while(n>=i){var t=f[n];if(t)return t;n--}return null}function g(n){return et(e,n)}function gt(n){return et(h,n)}function et(n,t){var i=t[rt];return i?n[i]:null}function ot(t){var f=t[1],i,r,s,h,e;(i=typeof f.newIndex=="number"?f.newIndex:f.direction==1?u+1:u-1,r=n.getFullData(i,!1,i<u),r)&&(i=r.idx,s={newIndex:i,oldIndex:u,triggerType:f.eventType,component:f.source},u=i,l=r,ni(r),sj_evt.fire(1,s),o)&&(h=g(r),h?(st(i),e=n.getFullData(r[c]+w-1),e&&!e.insights&&nt(r[c]+w-1,function(n){y(n)})):nt(i,function(n,t){y(n);p(i,t)},function(n){p(i,n)}))}function ni(n){for(var u,r,f,i=0;i<k.length;i++)u=k[i],r=t.ga(u,b),r&&(f="",n[r]&&(f=n[r]),u.innerHTML=f)}function p(n,t){var i=ft();i&&i.mid&&t.indexOf(i.mid)>=0&&st(n)}function st(n){var t=v(n,!0),i={index:n,resultData:t};sj_evt.fire(4,i)}function ht(n){var i=n[1],s,f,r,e,o,h,c,l;if(i!=null&&i.resultData!=null&&i.resultData.insights!=null&&i.index==u)for(s=i.resultData.insights,f=0;f<d.length;f++)r=d[f],e=t.ga(r,b),e&&(o="",s[e]&&(o=s[e]),h=r.firstChild,h&&r.removeChild(h),o&&(c=sj_ce("div"),c.innerHTML=o,l=c.firstChild,l&&r.appendChild(l)))}function nt(n,t,i){for(var u=[],h=[],l=0,f=n,r,o,a,v;l<w&&f!=null;)r=s(f),f=null,r&&(g(r)||(o=r[rt],o&&(u.push(o),e[o]={},a=r.ccid?r.ccid:"",h.push(a))),f=typeof r[c]!="undefined"?parseInt(r[c])+1:null),l++;u.length>0&&(v={mid:u.join(","),cid:h.join(",")},InsightsFetcher.fetch(v,!0,function(n){t(n,u)},function(){i(u)}))}function ti(n,t){var e=[],c,o,h,l,u;for(c in n)n.hasOwnProperty(c)&&e.push(n[c]);for(t&&(e=e.reverse()),i!=null&&r!=null&&(o=t?s(i).cidx:s(r).cidx),h=0;h<e.length;h++)l=e[h],u=l.idx,f[u]||(f[u]=l,i==null||r==null?o=f[u].cidx=i=r=u:(f[u].cidx=t?--o:++o,i=i>u?u:i,r=r<u?u:r))}function ii(t){t&&(n.favData=t)}function ri(n){var u={},i,f,r;return n.insights&&n.insights&&n.insights.caption&&(i=sj_ce("div"),i.innerHTML=n.insights.caption,f=i?t.gebc("cap_items",i):[],f.length>0&&(u.content=f[0].textContent,r=i?t.gebc("cap_link",i):[],r&&r.length>0&&(u.source=r[0].textContent))),u}var e={},f={};n.favData;var h={},t=pMMUtils,i,r,w=5,o=!1,tt="web",ct="webAns",it="insightsAns",rt="mid",c="idx",ut="mainImg",lt="insights",b="data-type",at="data-id",vt="data-metadata",yt="ext",k,d,u,l;n.init=pt;n.getFullData=v;n.getCurrentMetaData=ft;n.getContinuousIndex=wt;n.insertMainImage=bt;n.loadData=kt;n.loadInsightsData=y;n.getCaptionInfo=ri}(ImageDetailDataManager||(ImageDetailDataManager={}));ImageDetailDataManager.init(),function(){function o(){n=_ge("bar_l");i=_ge("bar_r");n&&i&&(r=parseInt(t.ga(n,"width")),u=parseInt(t.ga(i,"min-width")),r&&u&&SmartEvent.bind(_w,"resize",s))}function s(){var i=sb_de.clientWidth;i!=f&&(u+r>i?t.ac(n,e):t.rc(n,e));f=i}var f=sb_de.clientWidth,n,i,r,u,t=pMMUtils,e="wrap";o()}(),function(n){function ct(){(e=_ge("detail_film"),e&&(t.gcs(e)==null||t.gcs(e).display!="none"))&&(o=nt("iw",84),l=nt("hw",0),st=nt("ts",6),i=_ge("iol_fsc"),i&&(k=t.ga(i,"data-purl"),h=t.ga(i,"data-nurl")),li(),f().length>0?lt():i&&wi())}function f(){return i&&(ht=t.gebc("iol_fst",i)),ht}function lt(){ci();hi();ut()}function hi(){u=f()[r-y];u||(u=f()[0]);at();t.hc(u,p)||t.ac(u,p)}function ci(){var n=f();n&&(y=parseInt(t.ga(n[0],"idx"))||0,w=parseInt(t.ga(n[n.length-1],"idx"))||0)}function at(){var n,r,f,e;if(u&&l&&(n=u.parentNode,n&&(r=t.gebc("iol_grp",i),r))){for(f=0;f<r.length;f++)e=r[f],e!=n&&t.rc(e,tt);t.hc(n,tt)||t.ac(n,tt)}}function li(){sj_evt.bind(1,yt);sj_evt.bind(6,pt);sj_be(_w,"resize",ut);sj_be(e,"click",vt);s==null&&nt("esif",!1)&&typeof MMSwipe=="function"&&(s=new MMSwipe(i,e,null,di,ir));sj_be(_w,"unload",g);sj_evt.bind("ajax.unload",g)}function g(){sj_evt.unbind(1,yt);sj_evt.unbind(6,pt);sj_ue(_w,"resize",ut);sj_ue(e,"click",vt);s&&s.cu();sj_ue(_w,"unload",g);sj_evt.unbind("ajax.unload",g)}function vt(n){if(!rt){if(s&&s.im()){s.rsm();ei(n);return}var t=yi(n);t>=0&&bt(NavigationEventType.Click,t>r?1:0,t);ei(n)}}function yt(n){var t=n[1],i;r=t.newIndex;i=t.oldIndex;t.triggerType!=NavigationEventType.FilmStripSwipe&&vi(r,i);pi(r);at();kt()}function pt(n){rt=typeof n[1]=="boolean"?n[1]:!1}function ut(){ai();wt();kt()}function ai(){c=e.clientWidth/o;c=c%2==0?c+1:c}function wt(n){var c,u,s,a,h;typeof n=="undefined"&&(n=r);c=t.grtlsl(i);u=parseInt(t.ga(f()[0],"idx"));n=v(n);u=v(u);s=e.clientWidth/2-(n-u)*o-(o-st)/2;(a=f()[n])&&(h=a.parentNode,h&&(s-=t.ga(h,"idx")*l));ri(c,s)}function vi(n,r){var u,e;n=v(n);r=v(r);var h=t.grtlsl(i),a=(r-n)*o,c=0,s=f();s&&(u=s[r],e=s[n],u&&u.parentNode&&e&&e.parentNode&&(c=(t.ga(e.parentNode,"idx")-t.ga(u.parentNode,"idx"))*l));ri(h,h+a-c)}function yi(n){var i=-1,u=sj_et(n),r=t.gpc(u,si,oi);return r&&(i=parseInt(t.ga(r,"idx"))),i}function pi(n){var e=f(),o,i,r;e&&(o=t.ga(e[0],"idx"),o&&(i=parseInt(o),i=v(i),n=v(n),r=e[n-i],r&&(t.rc(u,p),t.ac(r,p),u=r)))}function bt(n,t,i){var r={eventType:n,direction:t,source:"filmstrip",newIndex:i};sj_evt.fire(7,r)}function kt(){var n=Math.ceil(c*1.5),t,i;k&&r-y<n&&(t=ft(k),y=-1e4,typeof AsyncFetcher!="undefined"&&AsyncFetcher&&AsyncFetcher.fetch&&AsyncFetcher.fetch(t,bi));h&&w-r<n&&(i=ft(h),w=1e4,typeof AsyncFetcher!="undefined"&&AsyncFetcher&&AsyncFetcher.fetch&&AsyncFetcher.fetch(i,dt,ti))}function wi(){if(typeof AsyncFetcher!="undefined"&&AsyncFetcher&&AsyncFetcher.fetch&&h){var n=ft(h);AsyncFetcher.fetch(n,ki,ti)}}function ft(n){if(n){var t=n.replace(/%SFX%/,String(++ot));return rr(t)}return null}function bi(n){var e=fi(n),r,u;gt(e)&&(ni(e,!0),r=e.firstChild,k=t.ga(r,"data-purl"),r.firstChild&&(t.ib(i,r.firstChild,i.firstChild),ii(r,!0),u=f(),u&&u.length>0&&(y=parseInt(t.ga(u[0],"idx"))||0)))}function dt(n){var e=fi(n),r,u;return gt(e)?(ni(e,!1),r=e.firstChild,h=t.ga(r,"data-nurl"),r.firstChild&&(t.a(i,r.firstChild),ii(r),u=f(),u&&u.length>0&&(w=parseInt(t.ga(u[u.length-1],"idx"))||0)),!0):!1}function ki(n){if(dt(n)){lt();var t={newIndex:r,eventType:NavigationEventType.FilmStripSwipe,direction:1};sj_evt.fire(7,t)}}function gt(n){for(var r=t.gebc("vtesthooks",n),i=r.length-1;i>=0;i--)t.r(n,r[i]);return n.childNodes.length==2&&t.ga(n.firstChild,"id")=="film"&&t.ga(n.lastChild,"id")=="ivd"}function ni(n,i){typeof ImageDetailDataManager!="undefined"&&ImageDetailDataManager.loadData&&(t.a(_ge("b_content"),n.lastChild),ImageDetailDataManager.loadData(i))}function ti(){h=null}function ii(n,r){var u,f,e;r===void 0&&(r=!1);u=parseInt(t.ga(n,"width"));f=parseInt(t.gcs(i).width);t.sw(i,f+u);r&&(e=t.grtlsl(i),ui(),t.rtlsl(i,e-u))}function di(n,r){t.hc(e,it)||t.ac(i,it);switch(b){case 0:rt||(b=t.gsd(r.X,r.Y,10,2.5));break;case 1:t.rtlsl(i,n+r.X);break;case 2:_w.scrollBy(0,-r.Y)}return!0}function gi(n,i){var e=f(),r,u;return e&&(r=e[n],u=e[i],r&&r.parentNode&&u&&u.parentNode)?(t.ga(u.parentNode,"idx")-t.ga(r.parentNode,"idx"))*l:0}function nr(n){for(var i,e,r=u,f=0;f<n;f++){if(i=r.nextSibling,i||(e=r.parentNode.nextSibling,e&&(i=e.firstChild,i&&l&&(t.hc(i,"iol_fst")||(i=i.nextSibling,++f),a=!0))),!i){a=!0;break}r=i}return t.hc(r,"iol_fst")||(r=r.nextSibling),r}function tr(n){for(var r,e,i=u,f=0;f<n;f++){if(r=i.previousSibling,r||(e=i.parentNode.previousSibling,e&&(r=e.lastChild,a=!0,++f)),!r){a=!0;break}i=r}return t.hc(i,"iol_fst")||(i=i.nextSibling),i}function ir(n,u){var f;if(b==1){f=Math.round(u.X/o);a=!1;var s=f>0?tr(f):nr(-f),h=a,e=parseInt(t.ga(s,"idx"))||0;t.rtlsl(i,n+f*o-gi(r,e));(h||e==r)&&wt(e);t.rc(i,it);bt(NavigationEventType.FilmStripSwipe,f>0?0:1,e)}return b=0,!0}function ri(n,r){typeof MMAnim!="undefined"&&MMAnim.transition?(ui(),sj_evt.fire(6,!0),d=MMAnim.transition(i,20,t.rtlsl,n,r,null,function(){sj_evt.fire(6,!1)})):t.rtlsl(i,r)}function ui(){d&&(d.stop(),d=null,sj_evt.fire(6,!1))}function fi(n){var t=sj_ce("div");return t.innerHTML=n,t}function ei(n){sj_pd(n);sj_sp(n)}function nt(n,t){return typeof FSConfig!="undefined"&&FSConfig&&FSConfig[n]?FSConfig[n]:t}function rr(n){return et?et.atb(n,"FS_"+String(ot)):n}function v(n){var t=n;return typeof ImageDetailDataManager!="undefined"&&(t=ImageDetailDataManager.getContinuousIndex(n)),t}var t=pMMUtils,et=typeof MMTestUtils!="undefined"?MMTestUtils:null,r=parseInt(t.qsv("selectedIndex",!0))||0,e,i,u,oi="iol_fst",p="iol_fsst",tt="iol_grp_sel",it="swiping",si="A",c,ot=0,y,w,o,l=0,st,s=null,b=0,rt=!1,a=!1,k=null,h=null,ht=[],d=null;n.init=ct;ct()}(ImageDetailFilmstrip||(ImageDetailFilmstrip={})),function(n){function nr(){SmartEvent.bindc(1,ir);SmartEvent.bindc(2,rr);SmartEvent.bindc(6,ur);SmartEvent.bind(v,a,ii);SmartEvent.bind(w,a,ii);SmartEvent.bind(yt,a,fr);SmartEvent.bind(p,a,or);SmartEvent.bind(_d,pi,sr);SmartEvent.bind(_w,"resize",ri);SmartEvent.bind(_w,"scroll",ri);ht&&SmartEvent.bind(wt,a,er);typeof IDConfig!="undefined"&&IDConfig.esim&&typeof MMSwipe=="function"&&(d=new MMSwipe(i.parentElement,null,null,wr,br));SmartEvent.bindc(SearchBoxEvent[0],tr);SmartEvent.bindc(DetailPageEvent[8],function(n){n.length>1&&(ti=n[1])})}function tr(n){var t=n[1];typeof t!="undefined"&&(ft=t)}function ir(n){ut=-1;var t=n[1];r=t.newIndex;Math.abs(t.newIndex-t.oldIndex)<=1?hr(t.newIndex<t.oldIndex):lr();ci();ui();fi()}function rr(n){h=typeof n[1]=="number"?n[1]:h;c=typeof n[2]=="number"?n[2]:c;ui();fi();lt()}function ur(n){nt=typeof n[1]=="boolean"?n[1]:!1}function ii(n){if(!nt){var t=sj_et(n);tt(NavigationEventType.Click,t==v?0:1);sj_pd(n);sj_sp(n)}}function fr(n){var u=sj_et(n),i=t.ga(u,"href");i&&(_w.open(i,"_blank"),yi(f(r),"mainimage","learnmore"));sj_pd(n);sj_sp(n)}function er(){ct(dt,{})}function or(n){var u,i;if(ti!=1){if(d&&d.im()){d.rsm();sj_pd(n);sj_sp(n);return}u=sj_et(n);t.hc(u,"mainImage")&&(i=f(r),i&&i.imgUrl&&(typeof MalwareWarning!="undefined"&&i.ismw?(sj_pd(n),sj_sp(n),MalwareWarning.show(i.imgUrl)):_w.open(i.imgUrl,"_blank"),yi(i,"mainimage","mainimage")))}}function sr(n){if(!nt){if(ft==1){if(n.keyCode==37){tt(NavigationEventType.Click,0);return}if(n.keyCode==39){tt(NavigationEventType.Click,1);return}}if(n.keyCode==27)if(ht)ct(dt,{});else{var t=f(r);t&&pInstr.logEvent(t.ns,"CI.Hide",t.key,"imageviewer",{Component:"escape"},null);history.back()}}}function ct(n,t){var i=_w.parent;i&&i.postMessage&&(t.command=n,i.postMessage(t,"*"))}function ri(){var n=t.gebc("mainImage",i)[0],e,u;n&&(e=parseFloat(t.gs(n,"width")),e&&(u=f(r),si(u.width,u.height,n)))}function tt(n,t){var i={eventType:n,direction:t,source:"currentimg"};sj_evt.fire(7,i)}function hr(n){if(n?(i.lastChild&&f(r+1)&&o(i.lastChild)>f(r+1).idx&&t.r(i,i.lastChild),s=0,i.firstChild&&t.hc(i.firstChild,"iol_imc")&&t.rtlsml(i.firstChild,0),u=i.firstChild):(i.firstChild&&f(r-1)&&o(i.firstChild)<f(r-1).idx&&t.r(i,i.firstChild),i.firstChild&&t.hc(i.firstChild,"iol_imc")&&t.rtlsml(i.firstChild,"-100%"),s=-i.clientWidth,u=i.lastChild),i.children.length<=1){var e=it(r);ar(e)}i.lastChild&&!t.hc(i.lastChild,l)&&sj_evt.fire(5);cr(n)}function cr(n){var e=n?f(r-1):f(r+1),u;e&&(u=it(e.idx),n?(s=-i.clientWidth,t.rtlsml(u,"-100%"),t.ib(i,u,i.firstChild)):t.a(i,u))}function lr(){while(i.firstChild)t.r(i,i.firstChild);var n=it(r);t.rtlsml(n,0);t.a(i,n);u=n;lt()}function ui(){r<=h?t.ac(v,b):t.rc(v,b);r>=c?t.ac(w,b):t.rc(w,b)}function fi(){for(var n,i=Math.max(r-ot,h),u=Math.min(r+ot,c),t=i;t<u+1;t++)n=f(t),n&&!n[e]&&oi(n)}function ei(n,i){var r,u,f;return t.ac(n,"mainImage"),r=sj_ce("div",null,wi),t.sa(r,"idx",i),u=sj_ce("span"),f=sj_ce("span"),f.appendChild(n),u.appendChild(f),r.appendChild(u),r}function it(n){var i=f(n);return i?i[e]&&!t.hc(i[e],l)?(t.rtlsml(i[e],0),i[e]):oi(i,!0):null}function oi(n,i){var r,f,u,o;if(n)return(r=null,i&&n[y]&&(f=new Image,f.src=n[y],r=ei(f,n.idx),si(n.width,n.height,f)),n.ismw)?(r&&t.rc(r,l),r):(!n[e]&&n[kt]&&(u=new Image,u.src=rt&&rt.imi()?rt.gmi():n[kt],u.onload=yr,u.onerror=pr,o=ei(u,n.idx),k.insertMainImage(n.idx,o)),i&&n[e]&&(t.sdt(n[e],0),t.a(r,n[e])),r)}function si(n,r,u){var f=Math.min(1,Math.min(i.clientWidth/n,i.clientHeight/r));t.sw(u,n*f);t.sh(u,r*f)}function ar(n){if(r==ut){ut=-1;return}t.a(i,n);u=n;var f=k.getCurrentMetaData();f&&f.itb&&n&&t.ac(n,"trans")}function hi(){return u?t.gebc("mainImage",u)[0]:null}function ci(){if(u&&!t.hc(u,l)&&u.parentNode){var n=hi();n&&(t.hc(u,bt)?n.parentNode.appendChild(pt):vr(n))}}function vr(n){et!=null&&n.parentNode.appendChild(et);n.parentNode.appendChild(vt)}function li(n){if(n.parentNode&&t.hc(n.parentNode,"iol_imc")&&n.parentNode.parentNode){var i=n.parentNode.parentNode;i.replaceChild(n,n.parentNode);o(n)<r&&t.rtlsml(n,"-100%");t.sdt(n,4)}}function yr(){var i=this,n=t.gpc(i,"DIV","iol_imc");n&&(t.rc(n,l),li(n),o(n)==r&&(o(u)!=r&&(u=n),ci(),sj_evt.fire(5)))}function pr(){var u=this,i=t.gpc(u,"DIV","iol_imc"),e,n;i&&(e=parseInt(t.ga(i,"idx")),n=f(e),n&&n[y]&&(t.ga(u,"src")==n[y]?t.rc(i,l):(u.src=n[y],li(i)),t.ac(i,bt),pInstr.logEvent(n.ns,"CI.Error",n.key,"ImageViewer",{Component:"currentimg",url:this.src},null)),o(i)==r&&sj_evt.fire(5))}function wr(n,r){switch(g){case 0:nt||(g=t.gsd(r.X,r.Y,gi,di));break;case 1:i.firstChild&&t.rtlsml(i.firstChild,s+r.X);break;case 2:_w.scrollBy(0,-r.Y)}return!0}function br(n,u,f){if(g==1){var e=i.clientWidth,o=kr(f,u,e);!o||o&&u.X<0&&r==c||o&&u.X>0&&r==h?i.firstChild&&t.rtlsml(i.firstChild,s):u.X>0?vi(e,0):vi(-e,1)}return g=0,!0}function kr(n,t,i){return n<250&&Math.abs(t.X)>20||Math.abs(t.X)>i/5}function o(n){var i=t.ga(n,"idx");return i?parseInt(i):-1}function lt(){var u=r-1,n;u>=h&&o(i.firstChild)>u&&(st=ai(u),st&&(s=-i.clientWidth,t.rtlsml(st,"-100%")));n=r+1;n<=c&&o(i.lastChild)<n&&(gt=ai(n),t.rtlsml(gt,0))}function ai(n){var u=it(n);return u!=null&&(n>r?t.a(i,u):t.ib(i,u,i.firstChild)),u}function vi(n,r){if(i.firstChild){sj_evt.fire(6,!0);t.std(i.firstChild,ni);t.rtlsml(i.firstChild,s+n);var u=sb_st(function(){t.std(i.firstChild,0);r!=null&&tt(NavigationEventType.Swipe,r);u&&(sb_ct(u),u=null);sj_evt.fire(6,!1)},ni)}}function yi(n,t,i){pInstr.logEvent(n.ns,"CI.Click",n.key,t,{Component:i,Mid:n.mid},null)}function f(n){var t=null,i;return typeof ImageDetailDataManager!="undefined"&&(i=n<r,t=ImageDetailDataManager.getFullData(n,!1,i)),t}function at(n,t){return typeof IDConfig!="undefined"&&IDConfig&&IDConfig[n]?IDConfig[n]:t}var t=pMMUtils,rt=typeof MMTestUtils!="undefined"?MMTestUtils:null,r=parseInt(t.qsv("selectedIndex",!0))||0,ut=r,ft,a="click",pi="keyup",p,v,w,i,vt,et,yt,pt,wt,u,h=0,c=0,b="iol_navd",wi="iol_imc loading valign_cont",l="loading",bt="loadError",ot,e="mainImg",kt="imgUrl",y="thUrl",dt="close",bi="loaded",k,st,gt,d=null,g=0,s=-1,ki,ht=!1,nt=!1,ni=500,di=at("sddt",2.5),gi=at("sddd",10),ti=0;n.init=function(){p=_ge("view_image_main");v=_ge("iol_navl");w=_ge("iol_navr");i=_ge("iol_imw");ot=at("pfic",0);k=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null;i&&(ki=t.grtlsl(i));vt=_ge("copy");et=_ge("can_fav");yt=_ge("copy_link");pt=_ge("detail_loadError");wt=_ge("back");u=i?i.firstChild:null;p&&(ht=t.ga(p,"data-defer-back-button-event")=="1");nr();k.loadData();ft=1;lt();ct(bi,{})};n.getCurrImg=function(){return hi()};n.init()}(ImageDetailMainImage||(ImageDetailMainImage={})),function(){function o(){(n=_ge("miniheader_data"),n)&&(sj_evt.bind(4,e),sj_be(_w,"unload",t),sj_evt.bind("ajax.unload",t),n&&n.lastChild&&f.ga(n.lastChild,"type")=="dls"&&(i=n.lastChild),r=parseInt(f.qsv("selectedIndex",!0))||0)}function t(){sj_evt.unbind(4,e);sj_ue(_w,"unload",t);sj_evt.unbind("ajax.unload",t)}function e(t){var f=t[1],u,e;f!=null&&r!=f.index&&(r=f.index,u=i,e=s(f.index),e&&n.appendChild(e),i=e,u&&u.parentNode&&u.parentNode.removeChild(u))}function s(n){var t,i;return u&&(t=u.getFullData(n,!0),t!=null&&t.insights!=null&&t.insights.dls)?(i=sj_ce("div"),i.innerHTML=t.insights.dls,i.firstChild):null}var i,u=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null,f=pMMUtils,n,r;o()}(ImageViewerDls||(ImageViewerDls={})),function(){function nt(){(o=_ge("bar_r"),t=_ge("highlights"),i=_ge("switcher"),r=_ge("isb_text"),t&&t.children&&o)&&(s=n.ga(t,"cross-fade"),s&&(h=parseInt(n.ga(t,"width"))),w=n.ga(o,"min-width"),r&&(n.sdt(r,1),l=r.offsetWidth,n.sdt(r,4)),tt())}function tt(){sj_evt.bind(4,k);sj_be(_w,"unload",c);sj_evt.bind("ajax.unload",c);SmartEvent.bind(_w,"resize",it)}function c(){f&&(clearInterval(f),f=null);sj_evt.unbind(4,k);sj_ue(_w,"unload",c);sj_evt.unbind("ajax.unload",c)}function k(n){var t=n[1];y=t.index;d(t.resultData)}function it(){var n=b?b.getFullData(y,!0):null;d(n)}function d(e){var b=!1,y=o.offsetWidth-w,k,d,p,c,g,it,nt,tt;for(r&&l&&(y-=l,y<0?n.ac(r,u):(n.rc(r,u),b=!0)),f&&(n.rc(i,v),clearInterval(f),f=null),k=[],d=0,p=0;p<t.children.length;p++)c=t.children[p],g=c.id,g&&(nt=n.ha(c,"data-source"),it=nt?e!=null?e.insights:null:e,ot(c,it,g,!nt)&&(d++,s?y>=h&&(d>1?n.ac(c,u):a=c):(y-=c.offsetWidth,y>=0?b=!0:n.ac(c,u)),tt=c.textContent||c.innerText,tt&&k.push(tt)));s&&(y>=h?(n.sw(t,h),rt()):n.sw(t,0));i&&n.sa(i,"title",k.join(" | "));et(b)}function rt(){e=a;f=setInterval(ft,g)}function ut(){if(e)for(var t=e.nextSibling;t;)if(n.ga(t,"is-format"))t=t.nextSibling;else return t;return a}function ft(){if(i&&(n.rc(i,v),n.ac(i,v)),e){n.ac(e,u);var t=ut();t&&n.rc(t,u);e=t}}function et(t){t?n.rc(i,p):n.ac(i,p)}function ot(t,i,r,f){var e;if(i&&i[r]){if(n.ra(t,"is-format"),n.rc(t,u),f)if(n.ha(t,"data-title-format")){var o=n.ga(t,"data-title-format"),s=n.ga(t,"data-title-singular-format"),h=i[r]=="1"?s:o;t.innerHTML=h.replace("{0}","<strong>"+i[r]+"<\/strong>")}else t.firstChild&&(e=t.firstChild,e.innerHTML=i[r]);else t.innerHTML=i[r];return!0}return n.sa(t,"is-format","1"),n.ac(t,u),!1}var n=pMMUtils,t,i,y,p="nohi",w=0,o,b=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null,r,l=0,u="hide",s=Boolean,g=2e3,f=null,e,a,h,v="cross_anim";nt()}(ImageViewerHighlights||(ImageViewerHighlights={})),function(){function f(){sj_evt.bind(1,r);sj_evt.bind(0,u);sj_be(_w,"unload",n);sj_evt.bind("ajax.unload",n)}function r(n){var r=n&&n.length>1?n[1]:null,f,u;r&&t&&(f=r.oldIndex<r.newIndex?"next":"prev",u=t.getFullData(r.newIndex,!1,r.oldIndex>r.newIndex),u&&pInstr.logEvent(u.ns,r.triggerType.name,u.key,"imageviewer",{Component:r.component,InstCategory:"ImageSeen",Mid:u.mid,Direction:f,InsightsStatus:InsightsStatus[i]},null))}function u(n){!n||n.length<2||(i=n[1])}function n(){sj_evt.unbind(1,r);sj_evt.unbind(0,u);sj_ue(_w,"unload",n);sj_evt.unbind("ajax.unload",n)}var t=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null,i=0;f()}(),function(){function e(){n=_ge("att_fi");n&&r&&t&&(f(),sj_evt.bind(1,u),sj_be(_w,"unload",i),sj_evt.bind("ajax.unload",i))}function i(){sj_evt.unbind(1,u);sj_ue(_w,"unload",i);sj_evt.unbind("ajax.unload",i)}function u(n){var t=n&&n.length>1?n[1]:null;t&&f()}function f(){var i=r.getCurrentMetaData(),f=t.ga(n,"href"),e=0,u,o;i&&f&&f!="#"&&(u=parseQueryParamsFromQuery(f),u.mid=i.mid,u.simid=i.docid,u.vw=i.vw,o=queryParamsToString(u),t.sa(n,"href",o),i.vw&&(e=4));t.sdt(n,e)}var r=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null,t=typeof pMMUtils!="undefined"?pMMUtils:null,n;e()}(),function(n){function r(n,r,u){if(n&&n.imageUrl&&typeof IVConfig!="undefined"&&IVConfig.fdurl){var f=IVConfig.fdurl.replace("/%IMAGEURL%/",encodeURIComponent(n.imageUrl)).replace("/%SFX%/",(++i).toString());n.imageWidth&&(f+="&imgW="+n.imageWidth);n.imageHeight&&(f+="&imgH="+n.imageHeight);t&&(f=t.atb(f,"faces"));f=addCommonPersistedParams(f);AsyncFetcher.fetch(f,r,u,u)}}var t=typeof MMTestUtils!="undefined"?MMTestUtils:null,i=0;n.fetchFaceFeature=r}(ImageVisionFetcher||(ImageVisionFetcher={})),function(){function it(){(t=_ge("show_face"),h=_ge("iol_imw"),e=_ge("face_error"),r=_ge("show_face_disclaimer"),t&&i&&y&&tt&&f&&c)&&(SmartEvent.bindc(1,o),SmartEvent.bind(_w,"scroll",o),SmartEvent.bind(t,"click",rt),g())}function o(){nt(!1);u();n.rc(t,"loading");g();r&&n.sdt(r,4)}function b(){r&&(s(r),v(r,1500,!1))}function rt(i){var r,u;n.hc(t,"loading")||(ut(),r=l(),r&&(u=n.gebc(p,r),u.length>0?(nt(!0),n.sdt(t,0),b()):(n.ac(t,"loading"),ft())),a("showface"),sj_pd(i),sj_sp(i))}function ut(){h&&sj_be(_w,"click",k);sj_be(_w,"unload",u);sj_evt.bind("ajax.unload",u)}function u(){h&&sj_ue(_w,"click",k);sj_ue(_w,"unload",u);sj_evt.unbind("ajax.unload",u)}function k(t){var r=sj_et(t),u,i,f;r&&(u=n.gpc(r,"SPAN","feature_content")||n.gpc(r,"SPAN","feature"),u?(i=n.ga(u,"href"),i&&(i=i.replace("/%QUERY%/",getCurrentQuery()),_w.open(i)),a("detectedfeature")):(f=n.gpc(r,"DIV",null,"show_face_disclaimer"),f?a("howolddisclaimer"):(o(),sj_pd(t),sj_sp(t))))}function ft(){var n=i.getCurrentMetaData(),t;n&&n.thUrl&&(t={imageUrl:n.thUrl,imageWidth:n.thW,imageHeight:n.thH},ImageVisionFetcher.fetchFaceFeature(t,et,d))}function et(r,u){var f=sj_ce("div"),o,e,h;f.innerHTML="<br>"+r;f.removeChild(f.firstChild);o=n.gebc("image_vision",f);o.length>0?(e=o[0],s(e),n.hc(e,"nofeature")?(h=i.getCurrentMetaData(),h&&(h.fc=0),v(e,3e3,!0)):b(),n.sdt(t,0)):d(u)}function d(n){o();ot(n)}function ot(n){if(e&&(s(e),v(e,3e3,!0)),typeof pInstr!="undefined"){var t=i.getCurrentMetaData();t&&pInstr.logEvent(t.ns,"CI.Error",t.key,"imagevision",{Component:"showface",url:n},null)}}function g(){var r=i.getCurrentMetaData();r&&r.fc!=null&&r.fc>0&&r.width>=c.minw&&r.height>=c.minh&&(s(t),n.sdt(t,4),w?f.cssAnimation(t,""):(n.ac(t,"active"),f.cssAnimation(t,"flash"),w=!0))}function nt(t){var u=l(),r,i;if(u)for(r=n.gebc(p,u),i=0;i<r.length;i++)n.sdt(r[i],t?4:0)}function l(){var n=y.getCurrImg();return n?n.parentNode:null}function s(n){var t=l();t&&t.appendChild(n)}function a(n){if(typeof pInstr!="undefined"){var t=i.getCurrentMetaData();t&&pInstr.logEvent(t.ns,"CI.Click",t.key,"imagevision",{Component:n},null)}}function v(t,i,r){if(t){n.sdt(t,1);n.so(t,1);var u=sb_st(function(){t&&f.fadeOut(t,10,null,function(){n.so(t,"");r&&n.sdt(t,4)});u&&(sb_ct(u),u=null)},i)}}var n=typeof pMMUtils!="undefined"?pMMUtils:null,f=typeof MMAnim!="undefined"?MMAnim:null,i=typeof ImageDetailDataManager!="undefined"?ImageDetailDataManager:null,y=typeof ImageDetailMainImage!="undefined"?ImageDetailMainImage:null,tt=typeof InsightsFetcher!="undefined"?InsightsFetcher:null,h,t,p="image_vision",w=!1,e,c=typeof IVConfig!="undefined"?IVConfig:null,r;it()}(ImageInsightsVision||(ImageInsightsVision={}))